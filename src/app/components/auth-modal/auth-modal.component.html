<ion-content class="ion-padding">
  <div class="container-auth" *ngIf="!showOtp">
    <div class="auth-section">
      <!-- Segment solo se muestra si no está logueado -->
      <ion-segment [(ngModel)]="segmentValue" mode="ios" *ngIf="!logeado">
        <ion-segment-button value="register">
          <ion-label>Crear cuenta</ion-label>
        </ion-segment-button>
        <ion-segment-button value="login">
          <ion-label>Iniciar sesión</ion-label>
        </ion-segment-button>
      </ion-segment>

      <!-- Contenido para usuarios logueados -->
      <div *ngIf="logeado">
        <ion-list>
          <ion-item lines="none">
            <ion-label class="head-login">
              <h2>Bienvenido, <span>Brayhan Garcia</span></h2>
            </ion-label>
          </ion-item>

          <ion-item lines="none" mode="ios" class="my-vehicle-card">
            <img class="brand-vehicle" slot="start" src="assets/brand.png" alt="Desvare">
            <ion-label class="ion-padding-vertical">
              <h3>Ford</h3>
              <p>Explorer</p>
            </ion-label>
            <div slot="end" class="placa">
              <h5>ZIV-026</h5>
            </div>
          </ion-item>
        </ion-list>

        <!-- Lista de vehículos siempre visible -->
        <ion-list mode="ios">
          <ion-item lines="none">
            <ion-label class="ion-no-padding">
              <h2 class="title-registered">Ó agrega uno nuevo</h2>
            </ion-label>
          </ion-item>
          <ion-item *ngFor="let vehicle of vehicles" class="ion-no-padding ion-no-margin">
            <img slot="start" [src]="vehicle.icon" [alt]="'Servicio de grúa para ' + vehicle.name">
            <ion-label>
              <h3>{{ vehicle.name }}</h3>
              <p>{{ vehicle.description }}</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </div>



      <!-- Contenido condicional basado en el estado de login -->
      <div *ngIf="!logeado">
        <div [ngSwitch]="segmentValue">
          <!-- Registro -->
          <div *ngSwitchCase="'register'">
            <ion-list mode="ios">
              <ion-item lines="none">
                <ion-label class="ion-padding-vertical">
                  <h2 class="title-register">Selecciona tu vehículo</h2>
                </ion-label>
              </ion-item>
              <ion-item *ngFor="let vehicle of vehicles" class="ion-no-padding ion-no-margin">
                <img slot="start" [src]="vehicle.icon" [alt]="'Servicio de grúa para ' + vehicle.name">
                <ion-label>
                  <h3>{{ vehicle.name }}</h3>
                  <p>{{ vehicle.description }}</p>
                </ion-label>
              </ion-item>
            </ion-list>
          </div>

          <!-- Inicio de sesión -->
          <div *ngSwitchCase="'login'">
            <div class="login-container">
              <div class="login-container-title">
                <h2>Ingresa a tu cuenta</h2>
                <p>Ingresa tu número celular ya registrado, para continuar con el servicio</p>
              </div>
              <ion-item lines="none" mode="ios" class="input-desvare">
                <img slot="start" src="assets/iconsax-svg/All/bold/call.svg" alt="phone">
                <ion-input label="Número celular" label-placement="floating" type="tel" [(ngModel)]="phoneNumber"
                  mask="(000) 000-0000" placeholder="(300) 123-4567">
                </ion-input>
              </ion-item>
              <ion-text color="danger" class="text-error" *ngIf="phoneError">{{ phoneError }}</ion-text>
              <ion-button expand="block" (click)="onSubmit()" [disabled]="isLoading">
                <ng-container *ngIf="!isLoading">
                  Ingresar
                </ng-container>
                <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
              </ion-button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- OTP -->
  <div *ngIf="showOtp">
    <div class="login-container">
      <div class="icon-circle">
        <img src="assets/iconsax-svg/All/bold/shield-tick.svg" alt="lock">
      </div>
      <div class="login-container-title">
        <h2>Ingrese el código</h2>
        <p>Hemos enviado un código de 6 dígitos a su teléfono móvil. </p>
      </div>
      <ion-item lines="none" mode="ios" class="input-desvare">
        <img slot="start" src="assets/iconsax-svg/All/bold/lock.svg" alt="lock">
        <ion-input label="Código de seguridad" label-placement="floating" type="tel" [(ngModel)]="otpCode" mask="000000"
          placeholder="123456">
        </ion-input>
      </ion-item>
      <ion-text color="danger" class="text-error" *ngIf="otpError">{{ otpError }}</ion-text>
      <ion-button expand="block" color="primary" (click)="validateOtp()" [disabled]="isLoading">
        <ng-container *ngIf="!isLoading">
          Validar código
        </ng-container>
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
      </ion-button>
      <ion-button expand="block" color="white" (click)="cancelarProceso()">Cancelar proceso</ion-button>
    </div>
  </div>

  <div *ngIf="logeado">
    <ion-button expand="block" color="white" (click)="cerrarSesion()">Cerrar sesión</ion-button>
  </div>
</ion-content>